

# 3.3.1. Memento

## Introdução

Este documento tem como objetivo apresentar a aplicação do padrão de projeto Memento, um dos padrões GoF (Gang of Four) (GAMMA et al., 1994). O Memento é um padrão da categoria Comportamental, focado em como os objetos gerenciam seus estados e responsabilidades.

O objetivo principal do padrão, conforme descrito nos slides da aula, é "permitir armazenar o estado interno de um objeto em um determinando momento, para que seja possível retorná-lo a este estado, sem que isso cause problemas com o encapsulamento". O Refactoring Guru (2025) complementa, afirmando que o Memento permite "salvar e restaurar o estado anterior de um objeto sem revelar os detalhes de sua implementação". Na prática, ele é a base para a criação de funcionalidades como "desfazer" (Ctrl+Z) (MIRANDA, 2020).

## Metodologia

Com base no escopo do sistema "Pode Pedir FCTE" e no objetivo do padrão Memento, foram analisadas diversas áreas onde a capacidade de salvar e restaurar estados seria benéfica. A avaliação considerou critérios como a necessidade de uma funcionalidade de "desfazer" (MIRANDA, 2020) e a importância de manter o encapsulamento dos objetos de domínio (GAMMA et al., 1994).

Durante o processo de análise, foram considerados os seguintes candidatos ao uso de Memento:

1.  **Carrinho de Compras (Gestão de Itens):** Permitir que o usuário desfaça a adição ou remoção de um item do carrinho.
2.  **Montagem de Item Personalizado:** Salvar o estado a cada ingrediente adicionado ou removido, permitindo que o usuário "volte" uma etapa na personalização.
3.  **Fluxo de Checkout:** Salvar o estado do pedido após o preenchimento de cada etapa (ex: endereço, forma de pagamento), permitindo ao usuário navegar para frente e para trás sem perder dados.

Dentre esses, o **Carrinho de Compras** foi selecionado como exemplo prático neste documento. A razão da escolha é que esta é a aplicação mais clássica e intuitiva do padrão, permitindo implementar uma funcionalidade de "desfazer" que é facilmente compreendida e agrega valor direto ao usuário, tudo isso sem quebrar a proteção dos dados internos do carrinho (REFACTORING GURU, 2025).

## Desenvolvimento

No projeto **Pode Pedir FCTE**, o padrão Memento foi aplicado para gerenciar o histórico de estados do `CarrinhoDeCompras`. Isso permite que o sistema salve um "snapshot" (MIRANDA, 2020) do carrinho antes de uma operação (como `removerItem()`) e, caso o usuário deseje, restaure o carrinho para esse estado anterior.

A implementação se baseia em três papéis principais, conforme definido pelo GoF (GAMMA et al., 1994) e apresentado nos slides:

1.  **Originator (Originador):** É o objeto que possui o estado interno que queremos salvar. No nosso caso, a classe `CarrinhoDeCompras`. Ela é responsável por criar um Memento com seu estado atual e também por saber como se restaurar a partir de um objeto Memento.
2.  **Memento:** É o objeto que armazena o estado interno do Originador. É importante que o Memento seja "opaco" para o Caretaker; ou seja, o Caretaker não deve conseguir acessar ou modificar o estado que está salvo dentro dele (REFACTORING GURU, 2025).
3.  **Caretaker (Zelador):** É a classe que "fica responsável por armazenar todas essas copias (mementos)". No nosso caso, uma classe `HistoricoCarrinho`. Ela guarda os Mementos (geralmente em uma pilha, para facilitar o "desfazer"), mas não sabe o que há dentro deles. Ela apenas os armazena e os devolve ao Originador quando solicitado (MIRANDA, 2020).

### Estrutura do Memento no Projeto

A estrutura segue a modelagem genérica apresentada na aula:

  * **Originator (`CarrinhoDeCompras`):** Possui o estado (`-state`) que será salvo. Tem o método `createMemento()`, que cria um `new Memento(this.state)`, e o método `restore(Memento m)`, que recupera o estado de um memento (`this.state = m.getState()`).
  * **Memento (`CarrinhoMemento`):** Armazena o estado (`-state`). Possui um método `getState()` que o Originador usa para se restaurar. Para garantir o encapsulamento, este Memento pode ser implementado como uma classe interna (aninhada) ao Originador (REFACTORING GURU, 2025).
  * **Caretaker (`HistoricoCarrinho`):** Mantém uma lista ou pilha de `CarrinhoMemento`. Possui métodos como `salvarEstado(Originator o)` (que chama `o.createMemento()` e guarda o resultado) e `desfazer(Originator o)` (que remove o último memento da pilha e chama `o.restore(memento)`).

\<font size="2"\>\<p style="text-align: center"\>\<b\>Figura 1:\</b\> Diagrama de classes genérico representando o padrão Memento (GoF)\</p\>\</font\>

\<div style="text-align: center;"\>

\</div\>

\<font size="2"\>\<p style="text-align: center"\>\<b\>Autor:\</b\> \<a href="https://github.com/Nathan-bs"\>Nathan Batista\</a\>, 2025 (Diagrama baseado em)\</p\>\</font\>

## Demonstração do Código sendo Executado

  - [Execução do Código](...)\</br\>
    Participantes: [Nathan Batista](https://github.com/Nathan-bs)\</br\>
  - [Repositório do Codigo](...)

## Conclusão

A aplicação do padrão Memento no `CarrinhoDeCompras` do projeto **Pode Pedir FCTE** demonstrou ser uma solução eficaz para implementar a funcionalidade de "desfazer".

O benefício central, alinhado ao objetivo do padrão, foi a capacidade de salvar e restaurar estados "sem violar o encapsulamento" (MIRANDA, 2020). A classe `HistoricoCarrinho` (Caretaker) pôde gerenciar múltiplos estados do `CarrinhoDeCompras` (Originator) sem ter acesso ou conhecimento sobre os detalhes internos (a lista de itens, os preços, etc.). Isso mantém o `CarrinhoDeCompras` coeso e seu encapsulamento intacto, delegando a responsabilidade de armazenamento para outra classe (REFACTORING GURU, 2025).

## Bibliografia

> GAMMA, Erich; HELM, Richard; JOHNSON, Ralph; VLISSIDES, John. *Design Patterns: Elements of Reusable Object-Oriented Software*. Addison-Wesley, 1994.

> MIRANDA, Otávio. **Memento Teoria - Padrões de Projeto - Parte 31/45**. [S. l.]: [s. n.], 20 set. 2020. 1 vídeo (13 min 33 s). Disponível em: http://www.youtube.com/watch?v=crmLq8\_FtLc. Acesso em: 22 out. 2025.

> REFATORING GURU. *Memento*. Disponível em: https://refactoring.guru/pt-br/design-patterns/memento. Acesso em: 22 out. 2025.

> SERRANO, Milene. AULA - GOFS COMPORTAMENTAIS. Slides. Universidade de Brasília, 2025.

## Histórico de Versões

| Versão | Data       | Descrição                                                             | Autor(es)                                      | Revisor(es) | Detalhes da revisão |
| ------ | ---------- | --------------------------------------------------------------------- | ---------------------------------------------- | ----------- | ------------------- |
| 1.0    | 22/10/2025 | Inicialização do Documento para o padrão Memento                      | [Cayo Alencar](https://github.com/Cayoalencar) |             |                     |
| 1.1    | 22/10/2025 | Adição de citações e referências bibliográficas                      |[Cayo Alencar](https://github.com/Cayoalencar)  |             |                     |